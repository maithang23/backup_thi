{
  "active": true,
  "connections": {
    "L·ªãch ki·ªÉm tra": {
      "main": [
        [
          {
            "node": "L·∫•y th√¥ng tin",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "L·∫•y th√¥ng tin": {
      "main": [
        [
          {
            "node": "Code",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code": {
      "main": [
        [
          {
            "node": "L∆∞u l·∫°i s·ªë l∆∞·ª£ng t·ªìn kho",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Filter": {
      "main": [
        [
          {
            "node": "G·ª≠i tin",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "L∆∞u l·∫°i s·ªë l∆∞·ª£ng t·ªìn kho": {
      "main": [
        [
          {
            "node": "Filter",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "createdAt": "2025-08-09T09:47:24.151Z",
  "id": "quUQn67RjhzmDDTl",
  "isArchived": false,
  "meta": {
    "templateCredsSetupCompleted": true
  },
  "name": "5 - H·ªìng - Ki·ªÉm tra ph√°t hi·ªán s·∫£n ph·∫©m t·ªìn kho √≠t v√† th√¥ng b√°o ƒë·∫øn Zalo",
  "nodes": [
    {
      "parameters": {
        "rule": {
          "interval": [
            {
              "triggerAtHour": 17
            }
          ]
        }
      },
      "type": "n8n-nodes-base.scheduleTrigger",
      "typeVersion": 1.2,
      "position": [
        -112,
        96
      ],
      "id": "c21469e2-41b5-4450-af3b-81ec92b77e2f",
      "name": "L·ªãch ki·ªÉm tra"
    },
    {
      "parameters": {
        "operation": "getAll",
        "returnAll": true,
        "options": {}
      },
      "type": "n8n-nodes-base.wooCommerce",
      "typeVersion": 1,
      "position": [
        112,
        96
      ],
      "id": "784fd68b-be7c-466d-99b8-5777181979c1",
      "name": "L·∫•y th√¥ng tin",
      "credentials": {
        "wooCommerceApi": {
          "id": "YeePakWQ7rvYheDB",
          "name": "WooCommerce sora"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// Duy·ªát qua t·ª´ng s·∫£n ph·∫©m trong danh s√°ch items v√† x·ª≠ l√Ω l·∫°i th√¥ng tin\nreturn items.map(item => {\n  \n  // L·∫•y gi√° tr·ªã t·ªìn kho g·ªëc t·ª´ d·ªØ li·ªáu (c√≥ th·ªÉ l√† s·ªë, null, undefined, chu·ªói...)\n  const rawQty = item.json.stock_quantity;\n  \n  // Ki·ªÉm tra t·ªìn kho c√≥ ph·∫£i l√† s·ªë h·ª£p l·ªá hay kh√¥ng\n  // N·∫øu ƒë√∫ng l√† s·ªë => gi·ªØ nguy√™n\n  // N·∫øu kh√¥ng ph·∫£i s·ªë (null, undefined, chu·ªói, NaN...) => g√°n l√† 0 ƒë·ªÉ tr√°nh l·ªói\n  const safeQty = (typeof rawQty === 'number' && !isNaN(rawQty))\n    ? rawQty\n    : 0;\n  \n  // Tr·∫£ v·ªÅ ƒë·ªëi t∆∞·ª£ng m·ªõi ƒë√£ x·ª≠ l√Ω s·∫°ch d·ªØ li·ªáu\n  return {\n    json: {\n      name: item.json.name,       // L·∫•y t√™n s·∫£n ph·∫©m\n      sku: item.json.sku || '',   // L·∫•y m√£ SKU, n·∫øu kh√¥ng c√≥ th√¨ g√°n chu·ªói r·ªóng\n      stock_quantity: safeQty     // G√°n t·ªìn kho ƒë√£ ki·ªÉm tra an to√†n\n    }\n  };\n});\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        352,
        96
      ],
      "id": "4795ad00-0bb1-4fa6-882c-74679ef90770",
      "name": "Code"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "99429380-8dfe-4ebd-8bce-24d6f85fcdb7",
              "leftValue": "={{ $json['s·ªë l∆∞·ª£ng'] }}",
              "rightValue": 30,
              "operator": {
                "type": "number",
                "operation": "lt"
              }
            }
          ],
          "combinator": "or"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.filter",
      "typeVersion": 2.2,
      "position": [
        880,
        96
      ],
      "id": "7a1cb1a3-7164-433e-b173-138907b07f38",
      "name": "Filter"
    },
    {
      "parameters": {
        "threadId": "1065949318692196563",
        "type": 1,
        "message": "=üì¶ S·∫£n ph·∫©m: {{ $json['T√™n s·∫£n ph·∫©m'] }}\n\nüßÆ S·ªë l∆∞·ª£ng c√≤n l·∫°i: {{ $json['s·ªë l∆∞·ª£ng'] }}\nüè∑Ô∏è SKU: {{ $('Code').item.json.sku }}\n=> ƒê√É ƒê·∫æN L√öC NH·∫¨P H√ÄNG",
        "quote": {},
        "mentions": {}
      },
      "type": "n8n-nodes-zalo-tools.zaloSendMessage",
      "typeVersion": 4,
      "position": [
        1120,
        96
      ],
      "id": "4108124f-a2d5-4e1a-9243-25f277aa632f",
      "name": "G·ª≠i tin",
      "credentials": {
        "zaloApi": {
          "id": "Q9ZDuWnqr1DHtDUl",
          "name": "Zalo API Sora"
        }
      }
    },
    {
      "parameters": {
        "operation": "appendOrUpdate",
        "documentId": {
          "__rl": true,
          "value": "1B24vujiYCwEvH75ogxNOHpAiaTuAn9kEo0Mh8jsZOrU",
          "mode": "list",
          "cachedResultName": "SPA Calla",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1B24vujiYCwEvH75ogxNOHpAiaTuAn9kEo0Mh8jsZOrU/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 451167433,
          "mode": "list",
          "cachedResultName": "Th√¥ng tin kho",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1B24vujiYCwEvH75ogxNOHpAiaTuAn9kEo0Mh8jsZOrU/edit#gid=451167433"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "T√™n s·∫£n ph·∫©m": "={{ $json.name }}",
            "s·ªë l∆∞·ª£ng": "={{ $json.stock_quantity }}"
          },
          "matchingColumns": [
            "T√™n s·∫£n ph·∫©m"
          ],
          "schema": [
            {
              "id": "T√™n s·∫£n ph·∫©m",
              "displayName": "T√™n s·∫£n ph·∫©m",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "s·ªë l∆∞·ª£ng",
              "displayName": "s·ªë l∆∞·ª£ng",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.6,
      "position": [
        608,
        96
      ],
      "id": "1ee8a2c6-0638-44a1-96a7-9ffc78297eaa",
      "name": "L∆∞u l·∫°i s·ªë l∆∞·ª£ng t·ªìn kho",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "jrdwFmaTBkFLjulZ",
          "name": "Sora"
        }
      }
    }
  ],
  "pinData": {},
  "settings": {
    "executionOrder": "v1"
  },
  "shared": [
    {
      "createdAt": "2025-08-09T09:47:24.151Z",
      "updatedAt": "2025-08-09T09:47:24.151Z",
      "role": "workflow:owner",
      "workflowId": "quUQn67RjhzmDDTl",
      "projectId": "XWfpQOL9AgFCyc6x"
    }
  ],
  "staticData": {
    "node:L·ªãch ki·ªÉm tra": {
      "recurrenceRules": []
    }
  },
  "tags": [],
  "triggerCount": 1,
  "updatedAt": "2025-08-24T08:14:56.406Z",
  "versionId": "f5db6815-bc2e-4420-a991-0c84995de685"
}